{% extends "base.html" %}
{% block content %}

<body>
    <script>
    Ext.setup({
    onReady: function () {
    var league = window.location.pathname.split("/")[2]
    var top_bar = Ext.create('Ext.Toolbar',{
        docked:'top',
        title: 'Loading...'

    })

    var match_list = Ext.create('Ext.List', {
    fullscreen:true,
    store: {
        fields: ['Date','FTHG','FTAG'],
        },

    itemTpl: '{FTHG}:{FTAG}  @  {Date}  ',
    items : [
    top_bar, {
        xtype:'button',
        
    }

    ],
    listeners:{
        select:function(thislist, record, eOpts){
            var query_url = window.location.search
            var new_url = query_url+'&Date='+record.data['Date']
            window.location = '/summary/'+league+'/'+new_url
        }
    }
    });
    
    var query_url = '/api/v1/'+league+'/'+window.location.search
    Ext.Ajax.setMethod('get')
    Ext.Ajax.setDisableCaching(false)
    Ext.Ajax.request({
        url: query_url,
        params:{
            limit:100,
            order_by:'-Date',
        },
        success: function(response){
            var responseObj = Ext.decode(response.responseText);
            newStore = {
            fields: ['Date','FTHG','FTAG'],
            data: responseObj['objects']
            },
            match_list.setStore(newStore)
            top_bar.setTitle('Recent games')
        }
    });
    }
});
    </script>
</body>
{% endblock %}
